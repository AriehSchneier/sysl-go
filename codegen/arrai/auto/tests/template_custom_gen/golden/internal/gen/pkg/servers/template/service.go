// Code generated by sysl DO NOT EDIT.
package template

import (
	"context"
	"fmt"
	"net/http"
	"net/url"

	"github.com/anz-bank/sysl-go/common"
	"github.com/anz-bank/sysl-go/restlib"
)

// Service interface for Template
type Service interface {
	GetEndpointList(ctx context.Context, req *GetEndpointListRequest) error
}

// Client for Template API
type Client struct {
	Client  *http.Client
	URL     string
	Headers map[string][]string
}

// NewClient for Template
func NewClient(client *http.Client, serviceURL string) *Client {
	return &Client{client, serviceURL, nil}
}

// GetEndpointList ...
func (s *Client) GetEndpointList(ctx context.Context, req *GetEndpointListRequest) error {
	required := []string{}
	u, err := url.Parse(fmt.Sprintf("%s/endpoint", s.URL))
	if err != nil {
		return common.CreateError(ctx, common.InternalError, "failed to parse url", err)
	}

	result, err := restlib.DoHTTPRequest2(ctx, &restlib.HTTPRequest{
		Client:        s.Client,
		Method:        "GET",
		URLString:     u.String(),
		Body:          nil,
		Required:      required,
		OKResponse:    nil,
		ErrorResponse: nil,
		ExtraHeaders:  nil,
	})
	restlib.OnRestResultHTTPResult(ctx, result, err)
	if err != nil {
		return common.CreateError(ctx, common.DownstreamUnavailableError, "call failed: Template <- GET "+u.String(), err)
	}

	if result.HTTPResponse.StatusCode == http.StatusUnauthorized {
		return common.CreateDownstreamError(ctx, common.DownstreamUnauthorizedError, result.HTTPResponse, result.Body, nil)
	}
	return nil
}
